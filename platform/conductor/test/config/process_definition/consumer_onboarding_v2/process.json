{
  "ownerApp": null,
  "createTime": 0,
  "updateTime": 1727780086061,
  "createdBy": null,
  "updatedBy": null,
  "name": "consumer_onboarding_process",
  "description": "Consumer Onboarding Process",
  "version": 41,
  "tasks": [
    {
      "name": "create_application",
      "taskReferenceName": "create_application",
      "description": null,
      "inputParameters": {
        "phone_number": "${workflow.input.phone_number}",
        "workflow_id": "${workflow.workflowId}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "create_identity",
      "taskReferenceName": "create_identity",
      "description": null,
      "inputParameters": {
        "phone_number": "${workflow.input.phone_number}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "create_entity",
      "taskReferenceName": "create_entity",
      "description": null,
      "inputParameters": {
        "phone_number": "${workflow.input.phone_number}",
        "identity_id": "${create_identity.output.identity_id}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "generate_kratos_recovery_flow",
      "taskReferenceName": "generate_kratos_recovery_flow",
      "description": null,
      "inputParameters": {
        "identity_id": "${create_identity.output.identity_id}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "send_otp_green_service",
      "taskReferenceName": "send_otp_green_service",
      "description": null,
      "inputParameters": {
        "otp": "${generate_kratos_recovery_flow.output.otp}",
        "phone_number": "${workflow.input.phone_number}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "update_application_with_consumer_id",
      "taskReferenceName": "update_application_with_consumer_id",
      "description": null,
      "inputParameters": {
        "consumer_id": "${create_entity.output.consumer_id}",
        "phone_number": "${workflow.input.phone_number}",
        "workflow_id": "${workflow.workflowId}",
        "flow_id": "${generate_kratos_recovery_flow.output.flow_id}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "set_passcode",
      "taskReferenceName": "set_passcode",
      "description": null,
      "inputParameters": {},
      "type": "HUMAN",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "timeoutSeconds": 600,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "fetch_consumer_credit_limit_from_scoring_by_phone",
      "taskReferenceName": "fetch_consumer_credit_limit_from_scoring_by_phone",
      "description": null,
      "inputParameters": {
        "phone_number": "${workflow.input.phone_number}"
      },
      "type": "SIMPLE",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": null,
      "expression": null
    },
    {
      "name": "is_consumer_mc",
      "taskReferenceName": "is_consumer_mc",
      "description": null,
      "inputParameters": {
        "user_exists": "${fetch_consumer_credit_limit_from_scoring_by_phone.output.user_exists}"
      },
      "type": "SWITCH",
      "dynamicTaskNameParam": null,
      "caseValueParam": null,
      "caseExpression": null,
      "scriptExpression": null,
      "decisionCases": {
        "false": [
          {
            "name": "update_application_step",
            "taskReferenceName": "update_application_step",
            "description": null,
            "inputParameters": {
              "phone_number": "${workflow.input.phone_number}",
              "step": "KYC_DATA"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "wait_consumer_kyc_data",
            "taskReferenceName": "wait_consumer_kyc_data",
            "description": null,
            "inputParameters": {
              "__humanTaskDefinition": {
                "assignmentCompletionStrategy": "LEAVE_OPEN"
              }
            },
            "type": "HUMAN",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "timeoutSeconds": 600,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "update_application_with_kyc_data",
            "taskReferenceName": "update_application_with_kyc_data",
            "description": null,
            "inputParameters": {
              "consumer_details": "${wait_consumer_kyc_data.output}",
              "phone_number": "${workflow.input.phone_number}",
              "consumer_id": "${create_entity.output.consumer_id}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "risk_process",
            "taskReferenceName": "risk_process",
            "description": null,
            "inputParameters": {
              "consumer_details": "${wait_consumer_kyc_data.output}",
              "phone_number": "${workflow.input.phone_number}",
              "consumer_id": "${create_entity.output.consumer_id}"
            },
            "type": "SUB_WORKFLOW",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": {
              "name": "risk_process",
              "version": null,
              "taskToDomain": null,
              "workflowDefinition": null
            },
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "update_application_with_risk_data",
            "taskReferenceName": "update_application_with_risk_data",
            "description": null,
            "inputParameters": {
              "risk_output": "${risk_process.output}",
              "phone_number": "${workflow.input.phone_number}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "lms_open_consumer_account",
            "taskReferenceName": "lms_open_consumer_account",
            "description": "Creates a consumer account in lms with inactive status",
            "inputParameters": {
              "consumer_id": "${create_entity.output.consumer_id}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "lms_update_consumer_account_status",
            "taskReferenceName": "lms_update_consumer_account_status",
            "description": "Updates consumer account to be active",
            "inputParameters": {
              "consumer_id": "${create_entity.output.consumer_id}",
              "status": "ACTIVE"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "create_user_profile",
            "taskReferenceName": "create_user_profile",
            "description": null,
            "inputParameters": {
              "consumer_id": "${create_entity.output.consumer_id}",
              "phone_number": "${workflow.input.phone_number}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          }
        ],
        "true": [
          {
            "name": "is_duplicate",
            "taskReferenceName": "is_duplicate",
            "description": null,
            "inputParameters": {
              "is_duplicate": "${fetch_consumer_credit_limit_from_scoring_by_phone.output.is_duplicate}"
            },
            "type": "SWITCH",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "decisionCases": {
              "true": [
                {
                  "name": "update_application_is_duplicate",
                  "taskReferenceName": "update_application_is_duplicate",
                  "description": null,
                  "inputParameters": {
                    "phone_number": "${workflow.input.phone_number}",
                    "scoring_output": "${fetch_consumer_credit_limit_from_scoring_by_phone.output}"
                  },
                  "type": "SIMPLE",
                  "dynamicTaskNameParam": null,
                  "caseValueParam": null,
                  "caseExpression": null,
                  "scriptExpression": null,
                  "dynamicForkJoinTasksParam": null,
                  "dynamicForkTasksParam": null,
                  "dynamicForkTasksInputParamName": null,
                  "startDelay": 0,
                  "subWorkflowParam": null,
                  "sink": null,
                  "optional": false,
                  "taskDefinition": null,
                  "rateLimited": null,
                  "asyncComplete": false,
                  "loopCondition": null,
                  "retryCount": null,
                  "evaluatorType": null,
                  "expression": null
                },
                {
                  "name": "wait_ssn",
                  "taskReferenceName": "wait_ssn",
                  "description": null,
                  "inputParameters": {
                    "__humanTaskDefinition": {
                      "assignmentCompletionStrategy": "LEAVE_OPEN"
                    }
                  },
                  "type": "HUMAN",
                  "dynamicTaskNameParam": null,
                  "caseValueParam": null,
                  "caseExpression": null,
                  "scriptExpression": null,
                  "dynamicForkJoinTasksParam": null,
                  "dynamicForkTasksParam": null,
                  "dynamicForkTasksInputParamName": null,
                  "startDelay": 0,
                  "subWorkflowParam": null,
                  "sink": null,
                  "optional": false,
                  "taskDefinition": null,
                  "rateLimited": null,
                  "asyncComplete": false,
                  "loopCondition": null,
                  "retryCount": null,
                  "evaluatorType": null,
                  "expression": null
                },
                {
                  "name": "fetch_consumer_credit_limit_from_scoring_by_national_id",
                  "taskReferenceName": "fetch_consumer_credit_limit_from_scoring_by_national_id",
                  "description": null,
                  "inputParameters": {
                    "national_id": "${wait_ssn.output.national_id}"
                  },
                  "type": "SIMPLE",
                  "dynamicTaskNameParam": null,
                  "caseValueParam": null,
                  "caseExpression": null,
                  "scriptExpression": null,
                  "dynamicForkJoinTasksParam": null,
                  "dynamicForkTasksParam": null,
                  "dynamicForkTasksInputParamName": null,
                  "startDelay": 0,
                  "subWorkflowParam": null,
                  "sink": null,
                  "optional": false,
                  "taskDefinition": null,
                  "rateLimited": null,
                  "asyncComplete": false,
                  "loopCondition": null,
                  "retryCount": null,
                  "evaluatorType": null,
                  "expression": null
                }
              ],
              "false": []
            },
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": "javascript",
            "expression": "$.is_duplicate ? 'true' : 'false' "
          },
          {
            "name": "assign_consumer_status_and_cl",
            "taskReferenceName": "assign_consumer_status_and_cl",
            "description": null,
            "inputParameters": {
              "phone_number": "${workflow.input.phone_number}",
              "scoring_by_phone": "${fetch_consumer_credit_limit_from_scoring_by_phone.output}",
              "scoring_by_national_id": "${fetch_consumer_credit_limit_from_scoring_by_national_id.output}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "fetch_consumer_details_from_mc",
            "taskReferenceName": "fetch_consumer_details_from_mc",
            "description": null,
            "inputParameters": {
              "national_id": "${wait_ssn.output.national_id}",
              "phone_number": "${workflow.input.phone_number}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "update_application_with_mc_data",
            "taskReferenceName": "update_application_with_mc_data",
            "description": null,
            "inputParameters": {
              "mc_output": "${fetch_consumer_details_from_mc.output}",
              "consumer_cl": "${assign_consumer_status_and_cl.output}",
              "phone_number": "${workflow.input.phone_number}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "create_user_profile_mc",
            "taskReferenceName": "create_user_profile_mc",
            "description": null,
            "inputParameters": {
              "consumer_id": "${create_entity.output.consumer_id}",
              "phone_number": "${workflow.input.phone_number}"
            },
            "type": "SIMPLE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          },
          {
            "name": "terminate",
            "taskReferenceName": "terminate",
            "description": null,
            "inputParameters": {
              "terminationStatus": "COMPLETED"
            },
            "type": "TERMINATE",
            "dynamicTaskNameParam": null,
            "caseValueParam": null,
            "caseExpression": null,
            "scriptExpression": null,
            "dynamicForkJoinTasksParam": null,
            "dynamicForkTasksParam": null,
            "dynamicForkTasksInputParamName": null,
            "startDelay": 0,
            "subWorkflowParam": null,
            "sink": null,
            "optional": false,
            "taskDefinition": null,
            "rateLimited": null,
            "asyncComplete": false,
            "loopCondition": null,
            "retryCount": null,
            "evaluatorType": null,
            "expression": null
          }
        ]
      },
      "dynamicForkJoinTasksParam": null,
      "dynamicForkTasksParam": null,
      "dynamicForkTasksInputParamName": null,
      "startDelay": 0,
      "subWorkflowParam": null,
      "sink": null,
      "optional": false,
      "taskDefinition": null,
      "rateLimited": null,
      "asyncComplete": false,
      "loopCondition": null,
      "retryCount": null,
      "evaluatorType": "javascript",
      "expression": "$.user_exists ? 'true' : 'false' "
    }
  ],
  "inputParameters": [
    "phone_number"
  ],
  "outputParameters": {},
  "failureWorkflow": "consumer_onboarding_failure_process",
  "schemaVersion": 2,
  "restartable": true,
  "workflowStatusListenerEnabled": false,
  "ownerEmail": "petru.b.external@btech.com",
  "timeoutPolicy": "ALERT_ONLY",
  "timeoutSeconds": 3600,
  "variables": {},
  "inputTemplate": {}
}